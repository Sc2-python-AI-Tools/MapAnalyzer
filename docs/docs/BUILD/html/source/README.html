

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>README.MD &mdash; Sc2MapAnalyzer 0.0.53 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Command-Line Interface" href="vb.html" />
    <link rel="prev" title="MapAnalyzer.sc2pathlibp package" href="MapAnalyzer.sc2pathlibp.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: grey" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Sc2MapAnalyzer
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="MapAnalyzer.html">MapAnalyzer package</a></li>
<li class="toctree-l1"><a class="reference internal" href="MapAnalyzer.sc2pathlibp.html">MapAnalyzer.sc2pathlibp package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">README.MD</a></li>
<li class="toctree-l1"><a class="reference internal" href="#builds">Builds:</a></li>
<li class="toctree-l1"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="#why-do-we-need-this">Why Do we need this ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pathfinding">Pathfinding</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-influence">Adding influence :</a></li>
<li class="toctree-l2"><a class="reference internal" href="#results-from-8-runs-on-abysalreefle">Results from 8 runs On AbysalReefLE:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#how-to-plug-it-on-your-bot">How to plug it on your bot</a></li>
<li class="toctree-l1"><a class="reference internal" href="vb.html">Command-Line Interface</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sc2MapAnalyzer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>README.MD</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/source/README.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="readme-md">
<h1>README.MD<a class="headerlink" href="#readme-md" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="builds">
<h1>Builds:<a class="headerlink" href="#builds" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><img alt="build" src="https://github.com/eladyaniv01/SC2MapAnalysis/workflows/Build/badge.svg?branch-master" />
<a class="reference external" href="https://github.com/eladyaniv01/SC2MapAnalysis/tree/master">master</a></p></li>
<li><p><img alt="https://img.shields.io/github/package-json/v/eladyaniv01/SC2MapAnalysis?color-blue&amp;logo-EladYaniv01&amp;style-plastic" src="https://img.shields.io/github/package-json/v/eladyaniv01/SC2MapAnalysis?color-blue&amp;logo-EladYaniv01&amp;style-plastic" /> <a class="reference external" href="https://github.com/eladyaniv01/SC2MapAnalysis/blob/master/CHANGELOG">Changelog</a></p></li>
</ul>
</div>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>A standalone plugin for python SC2 api</p>
<p>Early Stage development,</p>
<ul class="simple">
<li><p><a class="reference external" href="#getting-started">Getting Started</a></p></li>
<li><p><a class="reference external" href="#Pathfinding">Pathfinding</a></p></li>
<li><p><a class="reference external" href="#How-to-plug-it-on-your-bot">How to plug it on your bot</a></p></li>
</ul>
</div>
<div class="section" id="why-do-we-need-this">
<h1>Why Do we need this ?<a class="headerlink" href="#why-do-we-need-this" title="Permalink to this headline">¶</a></h1>
<p>This module is inspired by plays like this one <a class="reference external" href="https://www.youtube.com/watch?v-NUQsAWIBTSk&amp;start-458">TY map positioning</a>
(notice how the army splits into groups, covering different areas,  tanks are tucked in corners, and so on)</p>
<p>Hopefully with the interface provided here, you will be able to build plays like that one!</p>
<p>it is meant to be a tool(extension) for <a class="reference external" href="https://github.com/BurnySc2/python-sc2/">BurnySc2</a></p>
<p>Thanks A lot to <a class="reference external" href="https://github.com/DrInfy">DrInfy</a> for solving one of the biggest challenges,  finding rare choke points.</p>
<p>check out his work</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/DrInfy/sharpy-sc2">Sharpy</a> for rapid bot development.</p></li>
<li><p><a class="reference external" href="https://github.com/DrInfy/sc2-pathlib">sc2pathlib</a>  a high performance rust module with python interface for pathfinding</p></li>
</ul>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">lzma</span>
<span class="kn">from</span> <span class="nn">MapData</span> <span class="kn">import</span> <span class="n">MapData</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">import_bot_instance</span>


<span class="c1">#if its from BurnySc2 it is compressed</span>
<span class="c1"># https://github.com/BurnySc2/python-sc2/tree/develop/test/pickle_data</span>
<span class="n">YOUR_FILE_PATH</span> <span class="o">-</span> <span class="s1">&#39;some_directory/map_file&#39;</span>
<span class="k">with</span> <span class="n">lzma</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">YOUR_FILE_PATH</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">raw_game_data</span><span class="p">,</span> <span class="n">raw_game_info</span><span class="p">,</span> <span class="n">raw_observation</span> <span class="o">-</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># mocking a bot object to initalize the map,  this is for when you want to do this while not in a game,  </span>
<span class="c1"># if you want to use it in a game just pass in the bot object like shown below </span>

<span class="n">bot</span> <span class="o">-</span> <span class="n">import_bot_instance</span><span class="p">(</span><span class="n">raw_import_bot_instancegame_data</span><span class="p">,</span> <span class="n">raw_game_info</span><span class="p">,</span> <span class="n">raw_observation</span><span class="p">)</span>


<span class="c1"># And then you can instantiate a MapData Object like so</span>
<span class="n">map_data</span> <span class="o">-</span> <span class="n">MapData</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>


<span class="c1"># plot the entire labeled map</span>
<span class="n">map_data</span><span class="o">.</span><span class="n">plot_map</span><span class="p">()</span>

<span class="c1"># red dots or X are vision blockers,</span>
<span class="c1"># ramps are marked with white dots </span>
<span class="c1"># ramp top center is marked with &#39;^&#39;</span>
<span class="c1"># gas geysers are yellow spades </span>
<span class="c1"># MDRampss are marked with R&lt;region_label&gt;</span>
<span class="c1"># height span is with respect to :   light - high , dark - low</span>
<span class="c1"># ChokeArea is marked with green heart suites</span>
<span class="c1"># Corners are marked with a red &#39;V&#39; </span>
</pre></div>
</div>
<p>&lt;img src-“https://user-images.githubusercontent.com/40754127/88463402-3fa1dc80-cebb-11ea-9da9-f80a219f1083.png”/&gt;</p>
<ul>
<li><p>access a Region like so(region_label is of type int):</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">region</span> <span class="pre">-</span> <span class="pre">map_data.regions[region_label]</span></code></strong></p>
</li>
<li><p>get a region by querying a point ( for example the position of the enemy )</p>
<p>if the point is not inside a region, will return None</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">region</span> <span class="pre">-</span> <span class="pre">map_data.in_region_p(point)</span></code></strong></p>
</li>
<li><p>get an area by querying a point ( for example the position of the enemy )</p>
<p>will always return Area</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">region</span> <span class="pre">-</span> <span class="pre">map_data.where(point)</span></code></strong></p>
</li>
<li><p>get all constructs by querying a point ( for example the position of the enemy )</p>
<p>will a list of area’s the point is in ( for example a MDRampArea and a Region could have mutual points )</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">region</span> <span class="pre">-</span> <span class="pre">map_data.where_all(point)</span></code></strong></p>
</li>
<li><p>other handy objects available through our interface</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">region.region_chokes</span></code></strong></p>
<p><strong><code class="docutils literal notranslate"><span class="pre">region.region_ramps</span></code></strong></p>
<p><strong><code class="docutils literal notranslate"><span class="pre">region.region_vision_blockers</span></code></strong></p>
<p><strong><code class="docutils literal notranslate"><span class="pre">region.bases</span></code></strong></p>
<p><strong><code class="docutils literal notranslate"><span class="pre">region.corners</span></code></strong></p>
</li>
<li><p>util methods</p>
<p>will return the closest point out of a list/ set of points , towards another point
useful for calculating which corner you would want to put static defense on,  or siege</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">MapData.closest_towards_point(self,</span> <span class="pre">points:</span> <span class="pre">List[Point2],</span> <span class="pre">target:</span> <span class="pre">Point2)</span> <span class="pre">-&gt;</span> <span class="pre">Point2</span></code></strong></p>
</li>
</ul>
</div>
<div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p><strong>you will need to have 64 bit python installed</strong></p>
<p>create a virtual environment,  and clone the repo into it</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.</span></code></p>
<p>or if you want to contribute, or run tests locally</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.[dev]</span></code></p>
<p>or just with</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements.txt</span></code></p>
<p>to get an idea of what the api can do,  check out “run.py” and “dummybot.py”  both should run to verify the installation and demosntrate some of the capabilites</p>
<p>Tested Maps ( <a class="reference external" href="https://ai-arena.net/">AiArena</a> and <a class="reference external" href="https://sc2ai.net/">SC2ai</a> ladder map pool) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;AbyssalReefLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AutomatonLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DeathAuraLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EphemeronLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EternalEmpireLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EverDreamLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GoldenWallLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IceandChromeLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NightshadeLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PillarsofGoldLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SimulacrumLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SubmarineLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Triton.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;WorldofSleepersLE.xz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ZenLE.xz&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="pathfinding">
<h2>Pathfinding<a class="headerlink" href="#pathfinding" title="Permalink to this headline">¶</a></h2>
<p>getting the basic pathing grid :</p>
<p><code class="docutils literal notranslate"><span class="pre">map_data.get_pyastar_grid()</span></code></p>
</div>
<div class="section" id="adding-influence">
<h2>Adding influence :<a class="headerlink" href="#adding-influence" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">add_influence(p:</span> <span class="pre">Tuple[int,</span> <span class="pre">int],</span> <span class="pre">r:</span> <span class="pre">int,</span> <span class="pre">arr:</span> <span class="pre">ndarray,</span> <span class="pre">weight:</span> <span class="pre">int</span> <span class="pre">-</span> <span class="pre">100)</span> <span class="pre">-&gt;</span> <span class="pre">ndarray:</span></code></p>
<p>Usage:</p>
<p><code class="docutils literal notranslate"><span class="pre">map_data.add_influence(p,</span> <span class="pre">r,</span> <span class="pre">arr,</span> <span class="pre">weight)</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code>: center point (for example p could be an enemy units position)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code>: radius (for example  r -&gt;  attack range)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code>: how much cost to be added</p></li>
</ul>
<p><strong>the optimal cost will be 1</strong>,</p>
<p><strong>and the worst cost would be np.inf( for non pathable cells)</strong></p>
<p>so you should keep that in mind if you want to create a complex influence map with different weights</p>
<p><code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">pathfind(self,</span> <span class="pre">start:</span> <span class="pre">Tuple[int,</span> <span class="pre">int],</span> <span class="pre">goal:</span> <span class="pre">Tuple[int,</span> <span class="pre">int],</span> <span class="pre">grid:</span> <span class="pre">Optional[ndarray]</span> <span class="pre">-</span> <span class="pre">None,allow_diagonal-False,</span> <span class="pre">sensitivity:</span> <span class="pre">int</span> <span class="pre">-</span> <span class="pre">1)</span> <span class="pre">-&gt;</span> <span class="pre">ndarray:</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code>: start coordinates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">goal</span></code>: goal coordinates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid</span></code>: the weighted array to path through</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">allow_diagonal</span></code>: diagonal moves -&gt; if set to True will perforce slightly worst</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sensitivity</span></code>: default is 1,  what gaps between points is desired (in many use cases you will want to get every nth point of the path because its pointless to recompute every single point unless extensive micro is called for)</p></li>
<li><p>An example you can try out yourself to get a feel for it:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lzma</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">MapAnalyzer.MapData</span> <span class="kn">import</span> <span class="n">MapData</span>
<span class="kn">from</span> <span class="nn">MapAnalyzer.utils</span> <span class="kn">import</span> <span class="n">import_bot_instance</span>


<span class="k">def</span> <span class="nf">get_random_point</span><span class="p">(</span><span class="n">minx</span><span class="p">,</span> <span class="n">maxx</span><span class="p">,</span> <span class="n">miny</span><span class="p">,</span> <span class="n">maxy</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">minx</span><span class="p">,</span> <span class="n">maxx</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">miny</span><span class="p">,</span> <span class="n">maxy</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">get_map_file_list</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    easy way to produce less than all maps,  for example if we want to test utils, we only need one MapData object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">subfolder</span> <span class="o">-</span> <span class="s2">&quot;MapAnalyzer&quot;</span>
    <span class="n">subfolder2</span> <span class="o">-</span> <span class="s2">&quot;pickle_gameinfo&quot;</span>
    <span class="n">subfolder</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subfolder</span><span class="p">,</span> <span class="n">subfolder2</span><span class="p">)</span>
    <span class="n">folder</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="n">map_files_folder</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">subfolder</span><span class="p">)</span>
    <span class="n">map_files</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">map_files_folder</span><span class="p">)</span>
    <span class="n">li</span> <span class="o">-</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">map_file</span> <span class="ow">in</span> <span class="n">map_files</span><span class="p">:</span>
        <span class="n">li</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">map_files_folder</span><span class="p">,</span> <span class="n">map_file</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">li</span>


<span class="n">map_files</span> <span class="o">-</span> <span class="n">get_map_file_list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">mf</span> <span class="ow">in</span> <span class="n">map_files</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;reef&#39;</span> <span class="ow">in</span> <span class="n">mf</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">map_file</span> <span class="o">-</span> <span class="n">mf</span>
        <span class="k">break</span>


<span class="k">with</span> <span class="n">lzma</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">map_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">raw_game_data</span><span class="p">,</span> <span class="n">raw_game_info</span><span class="p">,</span> <span class="n">raw_observation</span> <span class="o">-</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">bot</span> <span class="o">-</span> <span class="n">import_bot_instance</span><span class="p">(</span><span class="n">raw_game_data</span><span class="p">,</span> <span class="n">raw_game_info</span><span class="p">,</span> <span class="n">raw_observation</span><span class="p">)</span>
<span class="n">map_data</span> <span class="o">-</span> <span class="n">MapData</span><span class="p">(</span><span class="n">bot</span><span class="p">)</span>

<span class="c1"># get corner regions centers for start / end points</span>
<span class="n">base</span> <span class="o">-</span> <span class="n">map_data</span><span class="o">.</span><span class="n">bot</span><span class="o">.</span><span class="n">townhalls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">reg_start</span> <span class="o">-</span> <span class="n">map_data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">position_tuple</span><span class="p">)</span>
<span class="n">reg_end</span> <span class="o">-</span> <span class="n">map_data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">map_data</span><span class="o">.</span><span class="n">bot</span><span class="o">.</span><span class="n">enemy_start_locations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="n">p0</span> <span class="o">-</span> <span class="n">reg_start</span><span class="o">.</span><span class="n">center</span>
<span class="n">p1</span> <span class="o">-</span> <span class="n">reg_end</span><span class="o">.</span><span class="n">center</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;generate random points for added influence / cost &quot;&quot;&quot;</span>
    <span class="n">pts</span> <span class="o">-</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">NUM_POINTS</span> <span class="o">-</span> <span class="n">idx</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">NUM_POINTS</span> <span class="o">-</span> <span class="mi">35</span>

    <span class="c1"># generating random points for added influence</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_POINTS</span><span class="p">):</span>
        <span class="n">pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_random_point</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">175</span><span class="p">))</span>

    <span class="sd">&quot;&quot;&quot;Requesting a grid and adding influence / cost&quot;&quot;&quot;</span>
    <span class="c1"># getting the base grid for pathing</span>
    <span class="n">arr</span> <span class="o">-</span> <span class="n">map_data</span><span class="o">.</span><span class="n">get_pyastar_grid</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">-</span> <span class="mi">7</span> <span class="o">+</span> <span class="n">idx</span>
    <span class="c1"># note that we use the default weight of 100,  we could pass custom weights for each point though</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">:</span>
        <span class="n">arr</span> <span class="o">-</span> <span class="n">map_data</span><span class="o">.</span><span class="n">add_influence</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">weight</span><span class="o">--</span><span class="mi">100</span><span class="p">)</span>

    <span class="sd">&quot;&quot;&quot;Plot path on weighted grid&quot;&quot;&quot;</span>
    <span class="n">map_data</span><span class="o">.</span><span class="n">plot_influenced_path</span><span class="p">(</span><span class="n">start</span><span class="o">-</span><span class="n">p0</span><span class="p">,</span> <span class="n">goal</span><span class="o">-</span><span class="n">p1</span><span class="p">,</span> <span class="n">weight_array</span><span class="o">-</span><span class="n">arr</span><span class="p">,</span> <span class="n">name</span><span class="o">-</span><span class="sa">f</span><span class="s2">&quot;Added </span><span class="si">{</span><span class="n">NUM_POINTS</span><span class="si">}</span><span class="s2"> of influence&quot;</span><span class="p">,</span>
                                  <span class="n">save</span><span class="o">-</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">-</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="results-from-8-runs-on-abysalreefle">
<h2>Results from 8 runs On AbysalReefLE:<a class="headerlink" href="#results-from-8-runs-on-abysalreefle" title="Permalink to this headline">¶</a></h2>
<p><img alt="MA_INF_Added 10 of influence" src="https://user-images.githubusercontent.com/40754127/89323316-299bd500-d68e-11ea-8f98-24e7d9e78e1e.png" />
<img alt="MA_INF_Added 20 of influence" src="https://user-images.githubusercontent.com/40754127/89323320-299bd500-d68e-11ea-8b89-d59d1387adca.png" />
<img alt="MA_INF_Added 30 of influence" src="https://user-images.githubusercontent.com/40754127/89323322-2a346b80-d68e-11ea-8de6-996565e40c6b.png" />
<img alt="MA_INF_Added 35 of influence" src="https://user-images.githubusercontent.com/40754127/89323304-24d72100-d68e-11ea-9ffc-8e835ea8c505.png" />
<img alt="MA_INF_Added 40 of influence" src="https://user-images.githubusercontent.com/40754127/89323308-26a0e480-d68e-11ea-9e8f-e93e7edb21b3.png" />
<img alt="MA_INF_Added 50 of influence" src="https://user-images.githubusercontent.com/40754127/89323311-27d21180-d68e-11ea-97c4-99d6acd3cfa3.png" />
<img alt="MA_INF_Added 60 of influence" src="https://user-images.githubusercontent.com/40754127/89323312-286aa800-d68e-11ea-854b-cfbb7beb261a.png" />
<img alt="MA_INF_Added 70 of influence" src="https://user-images.githubusercontent.com/40754127/89323315-29033e80-d68e-11ea-97cb-17957ee9675c.png" /></p>
</div>
</div>
<div class="section" id="how-to-plug-it-on-your-bot">
<h1>How to plug it on your bot<a class="headerlink" href="#how-to-plug-it-on-your-bot" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>The example below will get your main base, and enemy main base locations and plot the path between with no influence</p></li>
<li><p>MapData objects should be called <code class="docutils literal notranslate"><span class="pre">on_start</span></code> and is required only the bot object</p></li>
<li><p>it is recommended to set it to <code class="docutils literal notranslate"><span class="pre">None</span></code> on init(because its before <code class="docutils literal notranslate"><span class="pre">on_start</span></code>), and then set it on_start as shown below</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">sc2</span>
<span class="kn">from</span> <span class="nn">sc2.player</span> <span class="kn">import</span> <span class="n">Bot</span><span class="p">,</span> <span class="n">Computer</span>
<span class="kn">from</span> <span class="nn">sc2.position</span> <span class="kn">import</span> <span class="n">Point3</span>

<span class="kn">from</span> <span class="nn">MapAnalyzer</span> <span class="kn">import</span> <span class="n">MapData</span><span class="p">,</span> <span class="n">Point2</span>

<span class="n">GREEN</span> <span class="o">-</span> <span class="n">Point3</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">RED</span> <span class="o">-</span> <span class="n">Point3</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">BLUE</span> <span class="o">-</span> <span class="n">Point3</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
<span class="n">BLACK</span> <span class="o">-</span> <span class="n">Point3</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">MATester</span><span class="p">(</span><span class="n">sc2</span><span class="o">.</span><span class="n">BotAI</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_data</span> <span class="o">-</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">-</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_data</span> <span class="o">-</span> <span class="n">MapData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_data</span><span class="o">.</span><span class="n">logger</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">on_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>

        <span class="n">base</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">townhalls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">reg_start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">position_tuple</span><span class="p">)</span>
        <span class="c1"># self.logger.info(regstart)</span>
        <span class="n">reg_end</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_data</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enemy_start_locations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
        <span class="c1"># self.logger.info(regend)</span>
        <span class="n">p0</span> <span class="o">-</span> <span class="n">reg_start</span><span class="o">.</span><span class="n">center</span>
        <span class="n">p1</span> <span class="o">-</span> <span class="n">reg_end</span><span class="o">.</span><span class="n">center</span>
        <span class="n">path</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_data</span><span class="o">.</span><span class="n">pathfind</span><span class="p">(</span><span class="n">start</span><span class="o">-</span><span class="n">p0</span><span class="p">,</span> <span class="n">goal</span><span class="o">-</span><span class="n">p1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">debug_text_world</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;start </span><span class="si">{</span><span class="n">p0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">]),</span> <span class="n">Point2</span><span class="p">(</span><span class="n">p0</span><span class="p">),</span> <span class="n">color</span><span class="o">-</span><span class="n">RED</span><span class="p">,</span> <span class="n">size</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">debug_text_world</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;end </span><span class="si">{</span><span class="n">p1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">]),</span> <span class="n">Point2</span><span class="p">(</span><span class="n">p1</span><span class="p">),</span> <span class="n">color</span><span class="o">-</span><span class="n">RED</span><span class="p">,</span> <span class="n">size</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_point_list</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">text</span><span class="o">-</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_draw_point_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_list</span><span class="p">:</span> <span class="n">List</span> <span class="o">-</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">-</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">-</span><span class="kc">None</span><span class="p">,</span> <span class="n">box_r</span><span class="o">-</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">color</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">-</span> <span class="n">GREEN</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">point_list</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">-</span> <span class="n">Point2</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="n">h</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_terrain_z_height</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">-</span> <span class="n">Point3</span><span class="p">((</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">box_r</span><span class="p">:</span>
                <span class="n">p0</span> <span class="o">-</span> <span class="n">Point3</span><span class="p">((</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">box_r</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">box_r</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">box_r</span><span class="p">))</span> <span class="o">+</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
                <span class="n">p1</span> <span class="o">-</span> <span class="n">Point3</span><span class="p">((</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">box_r</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">box_r</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">box_r</span><span class="p">))</span> <span class="o">+</span> <span class="n">Point2</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">debug_box_out</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">color</span><span class="o">-</span><span class="n">color</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">debug_text_world</span><span class="p">(</span>
                        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">]),</span> <span class="n">pos</span><span class="p">,</span> <span class="n">color</span><span class="o">-</span><span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span>
                <span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nb">map</span> <span class="o">-</span> <span class="s2">&quot;AutomatonLE&quot;</span>
    <span class="n">sc2</span><span class="o">.</span><span class="n">run_game</span><span class="p">(</span>
            <span class="n">sc2</span><span class="o">.</span><span class="n">maps</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">map</span><span class="p">),</span>
            <span class="p">[</span><span class="n">Bot</span><span class="p">(</span><span class="n">sc2</span><span class="o">.</span><span class="n">Race</span><span class="o">.</span><span class="n">Terran</span><span class="p">,</span> <span class="n">MATester</span><span class="p">()),</span> <span class="n">Computer</span><span class="p">(</span><span class="n">sc2</span><span class="o">.</span><span class="n">Race</span><span class="o">.</span><span class="n">Zerg</span><span class="p">,</span> <span class="n">sc2</span><span class="o">.</span><span class="n">Difficulty</span><span class="o">.</span><span class="n">VeryEasy</span><span class="p">)],</span>
            <span class="n">realtime</span><span class="o">-</span><span class="kc">False</span>
    <span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">--</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vb.html" class="btn btn-neutral float-right" title="Command-Line Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="MapAnalyzer.sc2pathlibp.html" class="btn btn-neutral float-left" title="MapAnalyzer.sc2pathlibp package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Elad Yaniv

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>